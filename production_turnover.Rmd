---
title: "Root production and turnover"
output: 
  github_document:
    toc: yes
---
<!-- ## GitHub Documents -->

<!-- This is an R Markdown format used for publishing markdown documents to GitHub. When you click the **Knit** button all R code chunks are run and a markdown file (.md) suitable for publishing to GitHub is generated. -->

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
knitr::opts_chunk$set(fig.height = 8, fig.width = 6)
```

```{r load packages and data}
library(tidyverse)
df <- read_csv("data/processed_data/mr_roots_data_corrected.csv")
```

CW: use MR + models to get at dynamic rates with depth, and static cores to get biomass/length with depth, then propagate them together to get summed fluxes of production and turnover.

What changes happen in gross production and turnover?

Need to work on flagging zombies & wanderers

# Calculating Estimates of Root Production and Turnover
<!-- Milchunas (2009): "good agreement between pulse-isotope turnover and minirhizotron were obtained when minirhizotron estimates were *calculated from regression of decomposition versus production to equilibrium* and when pulse-isotope turnover estimates were calculated from two-phase life-span  regressions." -->

Turnover = entering decomposition, sloughing of roots ("gone"); deposition into the soil

  - individual present then gone (restrictive)
  - individual present but lost size (length and/or diameter; use volume? mass)

Split turnover into 2 parts

Alive --> Dead = senescence
Alive or Dead --> Gone = turnover (decomposition)

Alive to gone = senescence + turnover? (but wanderers)
 
 or

Force "dead" before it can be "gone" for turnover definition? Stronger confidence that it is truly gone into decomposition and turnover rather than wanderer.

We can infer that "Gone" roots reappearing as "Alive" later were "Alive" in between observations, but what about the hidden wanderers, those that haven't reappeared yet?  (Have yet to take any action related to this; all observations are treated as-is)

Rate/ratio of alive to dead at time t or time t to time t-1

Rate of production of "alive" roots

***New production & new loss for each root, then aggregate to the frame***

Calculate gross change for individual roots in length, diameter, and volume between each time step, for alive, dead, gone. The change values can then be aggregated to the depth window.

- flag completely new and totally gone?

Balogianni et al. (2016): "**Root production** was defined as the sum of the length of new roots formed and any increase in length of existing roots since the previous sampling day (Johnson et al. 2001). **Root mortality** was defined as the sum of the length of roots that had disappeared and any decrease in length of existing roots since the previous sampling day. Root production and mortality for each interval was expressed as the average meters of root length that appeared or disappeared per square meter image area per day (m m−2 days−1) in each tube."

Number of new root IDs since initiation in April
 
```{r new roots since April}
# df %>% distinct(root_ID)

april_roots <- df %>% 
  filter(Month == 4) 
new_roots <- df %>% 
  filter(Month > 4) %>% 
  filter(!root_ID %in% april_roots$root_ID)

# print(paste("April roots:", nrow(april_roots)))
# print(paste("Total new roots:", new_roots %>% distinct(root_ID) %>% nrow()))
```

April roots: `r nrow(april_roots)`

New roots: `r new_roots %>% distinct(root_ID) %>% nrow()`

That's more new root IDs than I thought there would be.

<!-- ## Analyzing individual roots -->
<!-- Rate of appearance in dead and gone column of individual roots -->

<!-- Individual roots days to senescence (dead) or turnover (gone) -->

<!-- Kaplan-Meier or Cox proportional hazard regression -->

<!-- - days to event (senescence or turnover) for individual roots -->
<!-- - 30-day step -->

<!-- Kaplan-Meier: estimate median survivorship/longevity of individual or cohort. "Censoring" for alive/dead - roots still alive at end of period results in underestimates longevity. -->

<!-- Cox: estimate "death hazard" at any given time in relation to other covariates -->

#  Figures

1. Length, Diameter, Production, Turnover by Depth

2. Length, Diameter, Production, Turnover by Day of Year (Month)


<!-- Size (diameter) & depth biplot of days to senescence -->

```{r add length and diam class groupings}
## Make size class groupings of root length
df <- df %>% 
  # group_by(root_status) %>% 
  mutate(length_bin = 
           case_when(
             Length_mm < 1 ~ "<1 mm",
             between(Length_mm, 1, 3) ~ "1 - 3 mm",
             between(Length_mm, 3.0001, 5) ~ ">3 - 5 mm",
             between(Length_mm, 5.0001, 7) ~ ">5 - 7 mm",
             between(Length_mm, 7.0001, 9) ~ ">7 - 9 mm",
             between(Length_mm, 9.0001, 11) ~ ">9 - 11 mm",
             between(Length_mm, 11.0001, 13) ~ ">11 - 13 mm",
             between(Length_mm, 13.0001, 15) ~ ">13 - 15 mm",
             # between(Length_mm, 8.0001, 9) ~ ">8 - 9 mm",
             # between(Length_mm, 9.0001, 10) ~ ">9 - 10 mm",
             Length_mm > 15 ~ ">15 mm"
           ) %>% 
           factor(levels = c("<1 mm","1 - 3 mm", ">3 - 5 mm", ">5 - 7 mm", 
                             ">7 - 9 mm", ">9 - 11 mm", ">11 - 13 mm", 
                             ">13 - 15 mm", 
                             # ">8 - 9 mm", 
                             # ">9 - 10 mm", 
                             ">15 mm"))
  )
  
df <- df %>% mutate(
  diam_bin = case_when(
    AvgDiam_cm < 1 ~ "<1 cm",
    between(AvgDiam_cm, 1, 1.5) ~ "1 - 1.5 cm",
    between(AvgDiam_cm, 1.5001, 2) ~ ">1.5 - 2 cm",
    between(AvgDiam_cm, 2.0001, 2.5) ~ ">2 - 2.5 cm",
    between(AvgDiam_cm, 2.5001, 3) ~ ">2.5 - 3 cm",
    between(AvgDiam_cm, 3.0001, 3.5) ~ ">3 - 3.5 cm",
    between(AvgDiam_cm, 3.5001, 4) ~ ">3.5 - 4 cm",
    between(AvgDiam_cm, 4.0001, 4.5) ~ ">4 - 4.5 cm",
    between(AvgDiam_cm, 4.5001, 5) ~ ">4.5 - 5 cm",
    between(AvgDiam_cm, 5.0001, 5.5) ~ ">5 - 5.5 cm",
    between(AvgDiam_cm, 5.5001, 6) ~ ">5.5 - 6 cm",
    AvgDiam_cm > 6 ~ ">6 cm"
    ) %>% 
    factor(levels = c(
      "<1 cm",
      "1 - 1.5 cm", 
      ">1.5 - 2 cm", 
      ">2 - 2.5 cm",
      ">2.5 - 3 cm",
      ">3 - 3.5 cm",
      ">3.5 - 4 cm",
      ">4 - 4.5 cm",
      ">4.5 - 5 cm",
      ">5 - 5.5 cm",
      ">5.5 - 6 cm",
      ">6 cm"))
  )
```

## Production and loss (change) of individual roots
Calculate gross change for individual roots in length, diameter, and volume between each time step, for alive, dead, gone. The change values can then be aggregated to the depth window.

<!-- CW: I think the main change is that we need to separate out the gains and losses. So, ind_gain_sum should actually be split into gross gain and gross loss. Then, the next step is to add new roots into the gross gain, and add newly dead or gone roots to the gross loss. -->

<!-- After doing that, we aggregate to each depth window, but now have gross production and gross turnover by window. -->

<!-- Is "gross loss" then the sum of 'Dead', 'Gone' and negative values of 'Alive'? -->

**Gross Gain** = growth of existing roots + new roots

**Gross Loss** = loss of existing roots + dead roots + gone roots

```{r individual_root_changes, echo=TRUE}
## Calculate gross gain and gross loss in length, diameter, and
## volume between each observation for each root

# calculate change of individual roots
## given the definition of gross gain & loss could do only 'Alive'
ind_chg <- df %>% 
  select(obs_ID, root_ID, Tube, Location, Date, Session, Month, root_status, 
         Length_mm, AvgDiam_cm, Volume_mm3) %>% 
  arrange(root_ID, Session) %>% 
  group_by(root_ID, root_status, Tube, Location) %>% 
  # lag subtracts the previous value; NAs when there is no value to subtract
  mutate(length_change = Length_mm - lag(Length_mm, n = 1),
         diam_change = AvgDiam_cm - lag(AvgDiam_cm, n = 1),
         volume_change = Volume_mm3 - lag(Volume_mm3, n = 1)) %>% 
  ungroup(.)

## Not a very elegant solution follows...
ind_gross_chg <- ind_chg %>% 
  # select(-Length_mm:-Volume_mm3) %>%
  rename(length = length_change, diameter = diam_change, 
         volume = volume_change) %>% 
  # long format to use metric as grouping variable
  pivot_longer(length:volume)

# gross gain = growth of 'Alive' + new roots
growth <- ind_gross_chg %>% 
  # summarise growth of existing roots to each depth
  filter(root_status == 'Alive', value >= 0) %>% 
  group_by(Tube, Location, Month, name) %>% 
  summarise(root_growth = sum(value)) %>% 
  ungroup(.)
# summary(growth)

# New roots after April
new_roots <- ind_gross_chg %>%
  # only roots that have NA for the change value
  filter(Month > 4, root_status == 'Alive', is.na(value)) %>% 
  distinct(root_ID, Tube, Location, Month) %>% 
  # get only these root IDs & recombine with gross values
  left_join(., ind_chg %>% select(root_ID, Tube, Location, Month, Length_mm:Volume_mm3)) %>%
  # rename in prep for joining with 'growth' data frame
  rename(length = Length_mm, diameter = AvgDiam_cm, 
         volume = Volume_mm3) %>%
  # match data format of 'growth'
  pivot_longer(length:volume) %>% 
  group_by(Tube, Location, Month, name) %>% 
  summarise(new_roots = sum(value)) %>% 
  ungroup(.)
# join growth with new roots
gain_depth <- left_join(growth, new_roots)
# add growth & new roots to get gross gain
gain_depth <- gain_depth %>% 
  mutate(
    # hacky solve of NAs from the join
    new_roots = ifelse(is.na(new_roots), 0, new_roots),
    gross_gain = root_growth + new_roots
    )

# gross loss = loss in 'Alive' + 'Dead' + 'Gone' 
# get loss in 'Alive' roots (analogous to 'growth')
loss <- ind_gross_chg %>%
  filter(root_status == 'Alive' & value < 0) %>% 
  group_by(Tube, Location, Month, name) %>% 
  summarise(root_loss = sum(abs(value))) %>% 
  ungroup(.)

# get amounts *newly* 'Dead' and 'Gone' roots (analogous to new_roots)
dead_gone <- ind_gross_chg %>%
  # only Dead & Gone roots that have NA for the change value
  filter(Month > 4, root_status %in% c('Dead', 'Gone'),
         is.na(value)) %>% 
  # get only these root IDs & recombine with gross values
  distinct(root_ID, Tube, Location, Month) %>% 
  left_join(., ind_chg %>% select(root_ID, Tube, Location, Month, Length_mm:Volume_mm3)) %>%
  rename(length = Length_mm, diameter = AvgDiam_cm,
         volume = Volume_mm3) %>%
  pivot_longer(length:volume) %>% 
  group_by(Tube, Location, Month, name) %>% 
  summarise(dg_roots = sum(value)) %>% 
  ungroup(.)

loss_depth <- left_join(dead_gone, loss)
loss_depth <- loss_depth %>% 
  mutate(root_loss = ifelse(is.na(root_loss), 0, root_loss),
    gross_loss = dg_roots + root_loss)

# Combine so that gross gain and gross loss are in one data frame
gross_change <- df %>%
  filter(Month > 4) %>% 
  distinct(Tube, Location, Month) %>% 
  left_join(., gain_depth) %>% 
  left_join(., loss_depth)

```

```{r net change, eval=F}
## Sum change values to depth window (this produces net change)
ind_chg_sum <- ind_chg %>% 
  group_by(Tube, Location, root_status, Month, Date) %>% 
  summarise(Length_mm = sum(Length_mm),
            AvgDiam_cm_sum = sum(AvgDiam_cm),# should this be averaged instead?
            Volume_mm3 = sum(Volume_mm3),
            length_change = sum(length_change, na.rm = T),
            diam_change = sum(diam_change, na.rm = T),
            volume_change = sum(volume_change, na.rm = T)
  ) %>% 
  ungroup(.)
```


Figure of gross gain and gross loss aggregated to depth window.

```{r plot_root_change, fig.width=8, fig.height=10}
# ind_chg %>% 
#   group_by(root_status) %>% 
#   select(length_change:volume_change) %>% 
#   skimr::skim()
# 
# ind_chg %>% view
# 
# ind_chg %>% 
#   filter(Tube == 12, Location == 39) %>% 
#   ggplot() +
#   geom_point(aes(Month, diam_change, color = root_ID, shape = root_status))

## Individual roots
# ggplot(ind_chg, aes(Location*-1, diam_change)) +
#   geom_point(alpha = .1) +
#   # stat_summary(fun.data = "mean_cl_boot", color = "red", size = .2) +
#   stat_summary(fun.data = "mean_se", color = "deepskyblue", size = .2) +
#   # stat_summary(fun = "median", color = "deepskyblue", size = .2) +
#   geom_smooth() +
#   coord_flip() +
#   facet_grid(Month ~ root_status) +
#   xlab("Relative depth") +
#   ylab("Change in average diameter (cm)") +
#   theme_bw() +
#   theme(
#     # legend.position = c(.8, .8),
#     # legend.title = element_blank(),
#     strip.background = element_blank(),
#     panel.grid.minor = element_blank()
#     )
gc <- gross_change %>% 
  filter(!is.na(gross_gain)) %>% 
  select(Tube:name, gross_gain, gross_loss) %>% 
  rename(metric = name) %>% 
  pivot_longer(gross_gain:gross_loss)

ggplot(gc, aes(Location*-1, value, color = name)) +
  geom_point(alpha = .2, size = .5) +
  geom_smooth(method = "gam", size = .5, show.legend = T, se = F) +
  scale_color_manual(values = c("deepskyblue", "red")) +
  coord_flip() +
  facet_grid(Month ~ metric, scales = "free_x") +
  xlab("Relative depth") +
  ylab("Gross change") +
  theme_bw() +
  theme(
    strip.background = element_blank(),
    panel.grid.minor = element_blank(),
    legend.title = element_blank()
    )

# ggplot(ind_chg_sum, aes(Location*-1, diam_change, color = root_status)) +
#   geom_point(alpha = .2, size = .5) +
#   geom_smooth(method = "gam", size = .5) +
#   coord_flip() +
#   facet_grid(Month ~ root_status) +
#   xlab("Relative depth") +
#   # ylab("Total change in mean diameter (cm)") +
#   theme_bw() +
#   theme(
#     strip.background = element_blank(),
#     panel.grid.minor = element_blank()
#     )
# 
# ggplot(ind_chg_sum, aes(Location*-1, volume_change, color = root_status)) +
#   geom_point(alpha = .2, size = .5) +
#   geom_smooth(method = "gam", size = .5) +
#   coord_flip() +
#   facet_grid(Month ~ root_status) +
#   xlab("Relative depth") +
#   # ylab("Total change in mean diameter (cm)") +
#   theme_bw() +
#   theme(
#     strip.background = element_blank(),
#     panel.grid.minor = element_blank()
#     )

```

Sum gross production and gross loss, then compare to change between Time 1 and Time final.
Final observation was November (Month = 11). If "Alive" roots, Time 1 is April, otherwise Time 1 is May.

(I've discovered I'm not clear on what precisely to calculate for this check)

```{r check gain loss, echo=T}
# Change in gross gain and loss: November values minus May values
gross_change %>% 
  filter(Month %in% c(5, 11), !is.na(name)) %>% 
  group_by(name, Month) %>% 
  summarise(gross_gain = sum(gross_gain, na.rm = T),
            gross_loss = sum(gross_loss, na.rm = T)) %>% 
  ungroup(.) %>% 
  group_by(name) %>% 
  summarise(gg_chg = gross_gain - lag(gross_gain),
            gl_chg = gross_loss - lag(gross_loss)) 
  
# Sum of gross gain and gross loss across all months, and their difference
gross_change %>%
  filter(!is.na(name)) %>% 
  group_by(name) %>% 
  summarise(gross_gain = sum(gross_gain, na.rm = T),
            gross_loss = sum(gross_loss, na.rm = T),
            net_change = gross_gain - gross_loss)

# Change in 'Alive' roots from April to November
df %>% 
  filter(Month %in% c(4, 11), root_status == "Alive") %>% 
  group_by(Month) %>% 
  summarise(length = sum(Length_mm),
            diameter = sum(AvgDiam_cm),
            volume = sum(Volume_mm3)) %>% 
  ungroup(.) %>% 
  mutate(l_chg = length - lag(length),
         d_chg = diameter - lag(diameter),
         v_chg = volume - lag(volume))

# Change in Dead/Gone roots from May to November
df %>% 
  filter(Month %in% c(5, 11), root_status %in% c("Dead", "Gone")) %>% 
  group_by(Month) %>% 
  summarise(length = sum(Length_mm),
            diameter = sum(AvgDiam_cm),
            volume = sum(Volume_mm3)) %>% 
  ungroup(.) %>% 
  mutate(l_chg = length - lag(length),
         d_chg = diameter - lag(diameter),
         v_chg = volume - lag(volume))

```


## Root measurements aggregated to depth window ("location")
The sum of each metric was calculated at each combination of Tube, Location (depth), Month & Date (equivalent but keeping Date handy), and root_status.

In the plots, points are the sum values and lines are the fit from `geom_smooth(method = 'gam', formula = 'y ~ s(x, bs="cs)')`.

We have totals for:

- root length (mm)
- projected area (mm2)
- surface area (mm2)
- average diameter (cm)
- volume (mm3)

```{r agg_to_depth}
df2 <- df %>% 
  group_by(Tube, Location, root_status, Month, Date) %>% 
  summarise(Length_mm = sum(Length_mm),
            ProjArea_mm2 = sum(ProjArea_mm2),
            SurfArea_mm2 = sum(SurfArea_mm2),
            AvgDiam_cm_sum = sum(AvgDiam_cm),# should this be averaged instead?
            AvgDiam_cm_avg = mean(AvgDiam_cm),
            Volume_mm3 = sum(Volume_mm3)) %>% 
  ungroup(.)
```

```{r total_root_length_depth_month}
ggplot(df2, aes(Location*-1, Length_mm)) +
  geom_point(alpha = .2) +
  # stat_summary(fun.data = "mean_se", color = "deepskyblue", size = .2) +
  geom_smooth(method = "gam") +
  coord_flip() +
  facet_grid(Month ~ root_status) +
  xlab("Relative depth") +
  ylab("Total root length (mm)") +
  theme_bw() +
  theme(
    # legend.position = c(.8, .8),
    # legend.title = element_blank(),
    strip.background = element_blank(),
    panel.grid.minor = element_blank()
    )
```

"It develops mid-section girth - a beer belly - over the season" -CW :)

```{r total_avg_diam}
ggplot(df2, aes(Location*-1, AvgDiam_cm_sum)) +
  geom_point(alpha = .2) +
  geom_smooth(method = "gam") +
  coord_flip() +
  facet_grid(Month ~ root_status) +
  xlab("Relative depth") +
  ylab("Total mean diameter (cm)") +
  theme_bw() +
  theme(
    strip.background = element_blank(),
    panel.grid.minor = element_blank()
    )
```

```{r total_volume}
ggplot(df2, aes(Location*-1, Volume_mm3)) +
  geom_point(alpha = .2) +
  geom_smooth(method = "gam") +
  coord_flip() +
  facet_grid(Month ~ root_status) +
  xlab("Relative depth") +
  ylab("Total volume (mm3)") +
  theme_bw() +
  theme(
    strip.background = element_blank(),
    panel.grid.minor = element_blank()
    )
```


<!-- Are these surface area estimates of current interest? -->
```{r total_surface_area, eval=F}
ggplot(df2, aes(Location*-1, SurfArea_mm2)) +
  geom_point(alpha = .2) +
  geom_smooth(method = "gam") +
  coord_flip() +
  facet_grid(Month ~ root_status) +
  xlab("Relative depth") +
  ylab("Total surface area (mm2)") +
  theme_bw() +
  theme(
    strip.background = element_blank(),
    panel.grid.minor = element_blank()
    )
```

```{r total_proj_area, eval=F}
ggplot(df2, aes(Location*-1, ProjArea_mm2)) +
  geom_point(alpha = .2) +
  geom_smooth(method = "gam") +
  coord_flip() +
  facet_grid(Month ~ root_status) +
  xlab("Relative depth") +
  ylab("Total projected area (mm2)") +
  theme_bw() +
  theme(
    strip.background = element_blank(),
    panel.grid.minor = element_blank()
    )
```


## Number of roots across size bins

<!-- add diameter bins -->

```{r bins_length_diam_fig, fig.height=6, fig.width=8}
length_bins <- ggplot(df, aes(length_bin, fill = root_status)) +
  geom_bar(position = "dodge") +
  scale_y_continuous(expand = c(0,0)) +
  xlab("Root length bin") +
  ylab("Root count") +
  facet_grid(Month~.) +
  theme_minimal() +
  theme(legend.position = c(.8, .8),
        legend.title = element_blank(),
        panel.grid.minor = element_blank())
length_bins

diam_bins <- ggplot(df, aes(diam_bin, fill = root_status)) +
  geom_bar(position = "dodge") +
  scale_y_continuous(expand = c(0,0)) +
  xlab("Root diameter bin") +
  ylab("Root count") +
  facet_grid(Month~.) +
  theme_minimal() +
  theme(legend.position = c(.8, .8),
        legend.title = element_blank(),
        panel.grid.minor = element_blank())
diam_bins

# ggpubr::ggarrange(
#   length_bins + theme(legend.position = "none"), 
#   diam_bins + ylab(" ")
# )
```


```{r density_plot_length_diam, fig.height=6, fig.width=6}
length_dens <- ggplot(df) +
  geom_density(aes(Length_mm, color = root_status)) +
  scale_x_continuous(breaks = c(seq(0,10, 2), 10, 20, 30, 40, 50, 60),
                     labels = c(seq(0,10, 2), 10, 20, 30, 40, 50, 60),
                     expand = c(.01,.01)) +
  scale_y_continuous(expand = c(.001,.001)) +
  xlab("Root length (mm)") +
  theme_minimal() +
  theme(legend.position = "none",
        # legend.title = element_blank(),
        panel.grid.minor = element_blank())
length_dens

diam_dens <- ggplot(df) +
  geom_density(aes(AvgDiam_cm, color = root_status)) +
  scale_x_continuous(breaks = c(seq(0,5, 1), 10, 20),
                     labels = c(seq(0,5, 1), 10, 20),
                     expand = c(.01,.01)) +
  scale_y_continuous(expand = c(.001,.001)) +
  xlab("Average root diameter (cm)") +
  theme_minimal() +
  theme(legend.position = "none",
        # legend.title = element_blank(),
        panel.grid.minor = element_blank())
diam_dens
```


## Individual roots
Plotted metrics by depth, month, and status

```{r root_length_depth_month}
ggplot(df, aes(Location*-1, Length_mm)) +
  geom_point(alpha = .2) +
  # stat_summary(fun.data = "mean_se", color = "deepskyblue", size = .2) +
  geom_smooth(method = "gam") +
  coord_flip() +
  facet_grid(Month ~ root_status) +
  xlab("Relative depth") +
  ylab("Root length (mm)") +
  theme_bw() +
  theme(
    # legend.position = c(.8, .8),
    # legend.title = element_blank(),
    strip.background = element_blank(),
    panel.grid.minor = element_blank()
    )
```

```{r diameter_depth_month}
ggplot(df, aes(Location*-1, AvgDiam_cm)) +
  geom_point(alpha = .2) +
  # stat_summary(fun.data = "mean_se", color = "deepskyblue", size = .2) +
  geom_smooth(method = "gam") +
  coord_flip() +
  facet_grid(Month ~ root_status) +
  xlab("Relative depth") +
  ylab("Root diameter") +
  theme_bw() +
  theme(
    # legend.position = c(.8, .8),
    # legend.title = element_blank(),
    strip.background = element_blank(),
    panel.grid.minor = element_blank()
    )
```



## Averaged individual root measurements

Root length, diameter, and volume by depth, month, and status.

Points are means, blue error bars are standard errors, red are 95% CI. Both calculated using `stat_summary()` implementation. The line is the fit from `geom_smooth(method = 'gam', formula = 'y ~ s(x, bs="cs)')`, the default action in this case.

<!-- Add figure of medians, mode, explore using standard deviation -->

```{r avg_length_depth_month}
ggplot(df, aes(Location*-1, Length_mm)) +
  # geom_point(alpha = .2) +
  # stat_summary(fun.data = "median_hilow", color = "red", size = .2) +
  stat_summary(fun.data = "mean_cl_boot", color = "red", size = .2) +
  stat_summary(fun.data = "mean_se", color = "deepskyblue", size = .2) +
  # stat_summary(fun = "median", color = "deepskyblue", size = .2) +
  geom_smooth() +
  coord_flip() +
  facet_grid(Month ~ root_status) +
  xlab("Relative depth") +
  ylab("Average root length (mm)") +
  theme_bw() +
  theme(
    # legend.position = c(.8, .8),
    # legend.title = element_blank(),
    strip.background = element_blank(),
    panel.grid.minor = element_blank()
    )
```

```{r avg_diam_depth_month}
ggplot(df, aes(Location*-1, AvgDiam_cm)) +
  # geom_point(alpha = .05) +
  # stat_summary(fun.data = "mean_sdl", color = "red", size = .2, fun.args = list(mult=1)) +
  stat_summary(fun.data = "mean_cl_boot", color = "red", size = .2) +
  stat_summary(fun.data = "mean_se", color = "deepskyblue", size = .2) +
  # stat_summary(fun = median, geom = "point", color = "red", size = .1) +
  geom_smooth() +
  coord_flip() +
  facet_grid(Month ~ root_status) +
  xlab("Relative depth") +
  ylab("Average root diameter (cm)") +
  theme_bw() +
  theme(
    # legend.position = c(.8, .8),
    # legend.title = element_blank(),
    strip.background = element_blank(),
    panel.grid.minor = element_blank()
    )
```

```{r avg_volume_depth_month}
ggplot(df, aes(Location*-1, Volume_mm3)) +
  # geom_point(alpha = .05) +
  # stat_summary(fun.data = "mean_sdl", color = "red", size = .2, fun.args = list(mult=1)) +
  stat_summary(fun.data = "mean_cl_boot", color = "red", size = .2) +
  stat_summary(fun.data = "mean_se", color = "deepskyblue", size = .2) +
  # stat_summary(fun = median, geom = "point", color = "red", size = .1) +
  geom_smooth() +
  coord_flip() +
  facet_grid(Month ~ root_status) +
  xlab("Relative depth") +
  ylab("Average root volume (mm3)") +
  theme_bw() +
  theme(
    strip.background = element_blank(),
    panel.grid.minor = element_blank()
    )
```
